FROM ansibleplaybookbundle/apb-base

LABEL "com.redhat.apb.spec"=\
"dmVyc2lvbjogMS4wCm5hbWU6IGt1YmVybmV0ZXMtY2xvdWQtZXZlbnQtbW9uaXRvci1hcGIKZGVz\
Y3JpcHRpb246IE1vbml0b3IgdGhlIGt1YmVybmV0ZXMgcGxhdGZvcm0gYW5kIGVtaXQgQ2xvdWQg\
RXZlbnRzCmJpbmRhYmxlOiBGYWxzZQphc3luYzogb3B0aW9uYWwKbWV0YWRhdGE6CiAgZGlzcGxh\
eU5hbWU6IEt1YmVybmV0ZXMgQ2xvdWQgRXZlbnQgTW9uaXRvcgogIGltYWdlVXJsOiAiaHR0cHM6\
Ly9hdmF0YXJzMi5naXRodWJ1c2VyY29udGVudC5jb20vdS8zMjA3NjgyOD9zPTIwMCZ2PTQiCnBs\
YW5zOgogIC0gbmFtZTogZGVmYXVsdAogICAgZGVzY3JpcHRpb246IFRoaXMgZGVwbG95cyB0aGUg\
S3ViZXJuZXRlcyBDbG91ZCBFdmVudCBNb25pdG9yCiAgICBmcmVlOiBUcnVlCiAgICBtZXRhZGF0\
YToge30KICAgIHBhcmFtZXRlcnM6CiAgICAtIG5hbWU6IGFkbWluX3VzZXIKICAgICAgdGl0bGU6\
IE9wZW5zaGlmdCBBZG1pbiBVc2VyCiAgICAgIHR5cGU6IHN0cmluZwogICAgICByZXF1aXJlZDog\
dHJ1ZQogICAgLSBuYW1lOiBhZG1pbl9wYXNzd29yZAogICAgICB0aXRsZTogT3BlbnNoaWZ0IEFk\
bWluIFBhc3N3b3JkCiAgICAgIHR5cGU6IHN0cmluZwogICAgICBkaXNwbGF5X3R5cGU6IHBhc3N3\
b3JkCiAgICAgIHJlcXVpcmVkOiB0cnVlCg=="

COPY playbooks /opt/apb/actions
COPY roles /opt/ansible/roles
RUN chmod -R g=u /opt/{ansible,apb}
USER apb
